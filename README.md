# simftp

**simftp**λ” ν„λ€μ μΈ μ†ν”„νΈμ›¨μ–΄ μ•„ν‚¤ν…μ²λ¥Ό κΈ°λ°μΌλ΅ μ„¤κ³„λ ν†µν•© FTP μ„λ²„ λ° ν΄λΌμ΄μ–ΈνΈ μ• ν”λ¦¬μΌ€μ΄μ…μ…λ‹λ‹¤. κ³ ν’μ§μ **μΈλΌμΈ UX/UI**μ™€ **λ¨λ“ν™”λ λ‚΄λ¶€ κµ¬μ΅°**λ¥Ό ν†µν•΄ μ„λ²„ κ΄€λ¦¬μ™€ νμΌ μ „μ†΅μ„ λ‹¨ ν•λ‚μ μΈν„°νμ΄μ¤μ—μ„ μ™„λ²½ν•κ² μ²λ¦¬ν•©λ‹λ‹¤.

---

## π“ μ‹μ¤ν… μ•„ν‚¤ν…μ² λ° λ°μ΄ν„° κµ¬μ΅°

### 1. λ°μ΄ν„° μ—”ν‹°ν‹° κ΄€κ³„λ„ (ERD)
λ³Έ ν”„λ΅μ νΈλ” μ¤‘μ•™ μ§‘μ¤‘μ‹ μ„¤μ • κ΄€λ¦¬μλ¥Ό ν†µν•΄ λ°μ΄ν„°μ μΌκ΄€μ„±μ„ μ μ§€ν•©λ‹λ‹¤.

### 1. λ°μ΄ν„° μ—”ν‹°ν‹° κ΄€κ³„λ„ (ERD)
λ³Έ ν”„λ΅μ νΈλ” μ¤‘μ•™ μ§‘μ¤‘μ‹ μ„¤μ • κ΄€λ¦¬μλ¥Ό ν†µν•΄ λ¨λ“  λ°μ΄ν„°λ¥Ό JSON λ° λ³΄μ• μ „μ© νμΌλ΅ κ΄€λ¦¬ν•©λ‹λ‹¤.

```mermaid
erDiagram
    CONFIG_MANAGER ||--|| SERVER_CONFIG_JSON : "μ…μ¶λ ¥"
    CONFIG_MANAGER ||--o{ USERS_JSON : "μ…μ¶λ ¥"
    CONFIG_MANAGER ||--|| CLIENT_CONFIG_JSON : "μ…μ¶λ ¥"
    CONFIG_MANAGER ||--|| MASTER_KEY : "μ•”νΈν™” ν‚¤"
    CONFIG_MANAGER ||--|| SSL_CERT_KEY : "FTPS μΈμ¦"

    SERVER_CONFIG_JSON {
        int port "μ„λΉ„μ¤ ν¬νΈ"
        string root "κΈ°λ³Έ λ£¨νΈ"
        bool nat "NAT μ°ν"
    }

    USERS_JSON {
        string id "PK"
        string pw "Encrypted(Fernet)"
        string home "μ‚¬μ©μ ν™"
        string perms "μ ‘κ·Ό κ¶ν•"
    }

    MASTER_KEY {
        binary secret "AES-256 Key"
    }

    SSL_CERT_KEY {
        file server_crt "κ³µκ°ν‚¤"
        file server_key "κ°μΈν‚¤"
    }
```

---

### 2. NAT ν™κ²½ μ ‘μ† νλ¦„λ„ (Network Flow)
μ™Έλ¶€λ§μ—μ„ λ‚΄λ¶€μ simftp μ„λ²„λ΅ μ ‘κ·Όν•  λ•μ λ°μ΄ν„° νλ¦„μ…λ‹λ‹¤.

```mermaid
sequenceDiagram
    participant User as μ™Έλ¶€ μ‚¬μ©μ (Client)
    participant Router as κ³µμ κΈ° (SK/KT/LG)
    participant Server as simftp μ„λ²„ (My PC)

    Note over User, Server: 1λ‹¨κ³„: μ μ–΄ μ±„λ„ μ ‘μ†
    User->>Router: μ ‘μ† μ‹λ„ (14729 ν¬νΈ)
    Router->>Server: ν¬νΈ ν¬μ›λ”© μ „λ‹¬
    Server-->>User: μ ‘μ† μΉμΈ (220)

    Note over User, Server: 2λ‹¨κ³„: λ°μ΄ν„° μ±„λ„ κ°λ°©
    User->>Server: νμΌ/λ©λ΅ μ”μ²­ (PASV)
    Server->>User: "60000-60100 ν¬νΈ μ¤‘ μ‚¬μ©"
    User->>Router: λ°μ΄ν„° ν†µλ΅ μ‹λ„
    Router->>Server: λ°μ΄ν„° κ°€κµ μ—­ν• 
    Server-->>User: μ‹¤μ  νμΌ μ „μ†΅ μ™„λ£
```

---

## π›΅οΈ κ°•ν™”λ λ³΄μ• μ‹μ¤ν… (Security)
μ•μ „ν• νμΌ κ΄€λ¦¬λ¥Ό μ„ν•΄ λ‹¤μκ³Ό κ°™μ€ λ‹¤μΈµ λ³΄μ• κΈ°μ μ΄ μ μ©λμ–΄ μμµλ‹λ‹¤.

*   **π”’ μ–‘λ°©ν–¥ μ•”νΈν™”**: λ¨λ“  κ³„μ • λΉ„λ°€λ²νΈλ” **AES-256 μ•κ³ λ¦¬μ¦κ³Ό κ³ μ  λ§μ¤ν„° ν‚¤**λ¥Ό μ‚¬μ©ν•μ—¬ μ•”νΈν™” μ €μ¥λ©λ‹λ‹¤.
*   **π›΅οΈ λΈλ£¨νΈ ν¬μ¤ λ°©μ§€**: λ΅κ·ΈμΈ 3ν μ‹¤ν¨ μ‹ ν•΄λ‹Ή μ„Έμ…μ„ μ¦‰μ‹ μ°¨λ‹¨ν•©λ‹λ‹¤.
*   **π¦ λ„μ¤(DoS) λ°©μ–΄**: μ „μ²΄ λ™μ‹ μ ‘μ† 50λ…, IPλ‹Ή 5κ°λ΅ μ ν•ν•μ—¬ μ„λ²„ μμ› κ³ κ°μ„ λ°©μ§€ν•©λ‹λ‹¤.
*   **π” FTPS μ§€μ›**: TLS/SSL κΈ°λ° μ•”νΈν™” μ „μ†΅μ„ ν†µν•΄ ν¨ν‚· μ¤λ‹ν•‘μ„ λ°©μ§€ν•©λ‹λ‹¤.
*   **β° μλ™ μ¬μ‹μ‘ μ¤μΌ€μ¤„λ¬**: λ§¤μΌ 00:01(KST)μ— μ„λ²„λ¥Ό μλ™ μ¬μ‹μ‘ν•μ—¬ λ°”λ€ κ³µμΈ IPλ¥Ό μλ™ κ°±μ‹ ν•©λ‹λ‹¤.

---

## π NAT λ° μ™Έλ¶€ μ ‘μ† κ°€μ΄λ“ (Port Forwarding)
κ³µμ κΈ° ν™κ²½μ—μ„ μ™Έλ¶€ μ ‘μ†μ„ μ„ν•΄ μ•„λ **λ‘ μ„¤μ •**μ„ κ³µμ κΈ°μ— λ“±λ΅ν•΄μ•Ό ν•©λ‹λ‹¤.

| κµ¬λ¶„ | ν”„λ΅ν† μ½ | ν¬νΈ λ²”μ„ | λ€μƒ IP | μ©λ„ |
| :--- | :--- | :--- | :--- | :--- |
| **λ…λ Ή μ±„λ„** | TCP | 14729 | λ‚΄ PC (.61) | λ…λ Ή λ° μ‘λ‹µ μ μ–΄ |
| **λ°μ΄ν„° μ±„λ„** | TCP | 60000 ~ 60100 | λ‚΄ PC (.61) | νμΌ μ „μ†΅ λ° λ©λ΅ ν‘μ‹ |

---

## π› οΈ μ„¤μ • λ° μ μ§€λ³΄μ (Settings)
μ„¤μ • νƒ­μ„ ν†µν•΄ μ‹μ¤ν…μ ν•µμ‹¬ λ³΄μ• μ”μ†λ¥Ό μ•μ „ν•κ² κ΄€λ¦¬ν•  μ μμµλ‹λ‹¤.

*   **β οΈ μ„ν— κµ¬μ—­ κ΄€λ¦¬**: λ§μ¤ν„° ν‚¤ λ° SSL μΈμ¦μ„λ¥Ό μλ™μΌλ΅ μ΄κΈ°ν™”/μ¬μƒμ„±ν•  μ μμµλ‹λ‹¤.
*   **π¨ 3λ‹¨κ³„ κ°•ν™” μ»¨ν**: μΉλ…μ μΈ λ°μ΄ν„° μ΄κΈ°ν™” μ‘μ—…μ€ **3ν μ—°μ† κ²½κ³ (1/3, 2/3, 3/3)**λ¥Ό λ¨λ‘ μΉμΈν•΄μ•Ό μ‹¤ν–‰λ©λ‹λ‹¤.
*   **π“¦ μƒλ€ κ²½λ΅ κΈ°λ° κ΄€λ¦¬**: λ¨λ“  μ„¤μ • νμΌκ³Ό ν‚¤λ” μ‹¤ν–‰ μ„μΉλ¥Ό κΈ°μ¤€μΌλ΅ ν•λ” **μƒλ€ κ²½λ΅(JSON)**μ—μ„ μ•μ „ν•κ² κ΄€λ¦¬λ©λ‹λ‹¤.

---

## π“‚ ν”„λ΅μ νΈ μƒμ„Έ κµ¬μ΅°
| νμΌ/λ””λ ‰ν† λ¦¬ | λ©μ  | νΉμ§• |
| :--- | :--- | :--- |
| `src/main.py` | ν”„λ΅κ·Έλ¨ μ§„μ…μ  | ν™κ²½ μ΄κΈ°ν™” λ° GUI μ‹μ‘ |
| `src/app.py` | λ©”μΈ ν”„λ μ„μ›ν¬ | νƒ­ κ΄€λ¦¬ λ° μΈν„°νμ΄μ¤ μ—°κ²° |
| `src/core/config.py` | μ„¤μ • κ΄€λ¦¬μ | λ¨λ“  JSON νμΌμ μ¤‘μ•™ μ μ–΄ |
| `src/core/utils.py` | λ³΄μ•/λ„¤νΈμ›ν¬ μ ν‹Έ | AES μ•”νΈν™”, SSL μƒμ„±, IP μ΅°ν |
| `src/gui/tabs/` | UI μ»΄ν¬λ„νΈ | μ„λ²„, ν΄λΌμ΄μ–ΈνΈ, μ„¤μ • λ…λ¦½ κµ¬μ„± |
| `config/*.json` | λ°μ΄ν„° μ €μ¥μ† | μ„λΉ„μ¤ μ„¤μ •, μ‚¬μ©μ λ©λ΅, ν΄λΌμ΄μ–ΈνΈ κΈ°λ΅ |
| `config/master.key` | λ§μ¤ν„° μ•”νΈν‚¤ | λΉ„λ°€λ²νΈ λ³µνΈν™”μ— ν•„μ”ν• ν•µμ‹¬ ν‚¤ |
| `config/server.*` | SSL μΈμ¦μ„ μ„ΈνΈ | μ•μ „ν• μ „μ†΅(FTPS)μ„ μ„ν• κ³µκ°/κ°μΈν‚¤ |

---

## π€ μ‹μ‘ν•κΈ°
1. `run.bat`λ¥Ό μ‹¤ν–‰ν•μ—¬ ν”„λ΅κ·Έλ¨μ„ μΌ­λ‹λ‹¤.
2. **Server** νƒ­μ—μ„ μ‚¬μ©μ κ³„μ •μ„ μƒμ„±ν•κ³  μ„λ²„λ¥Ό κ°€λ™ν•©λ‹λ‹¤.
3. κ³µμ κΈ° μ„¤μ •μ—μ„ ν¬νΈν¬μ›λ”© λ° **λ‚΄λ¶€ IP μμ•½(DHCP)**μ„ μ™„λ£ν•μ„Έμ”.
4. λ§¤μΌ 00:01μ— μ„λ²„κ°€ μλ™ μ¬μ‹μ‘λλ―€λ΅ μ λ™ IP ν™κ²½μ—μ„λ„ μ•μ‹¬ν•κ³  μ‚¬μ©ν•μ„Έμ”.
